<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SkillForge Digital • Identity Sync</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
    @keyframes zoom-in { from { transform: scale(0.98); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    .animate-in { animation: fade-in 0.6s ease-out forwards; }
    .zoom-in { animation: zoom-in 0.4s ease-out forwards; }
    @media print {
      body { background: white !important; color: black !important; -webkit-print-color-adjust: exact; }
      .no-print { display: none !important; }
      #print-slip { display: block !important; position: static !important; width: 100% !important; margin: 0 !important; height: auto !important; }
    }
    input:focus, select:focus { box-shadow: 0 0 0 2px rgba(245, 158, 11, 0.5); }
    select { appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 1rem center; background-size: 1em; }
  </style>
</head>
<body class="min-h-screen bg-[#06080a] text-slate-100 font-sans selection:bg-amber-500/30">

  <div class="fixed inset-0 overflow-hidden pointer-events-none no-print">
    <div class="absolute top-[-10%] right-[-10%] w-[40%] h-[40%] bg-amber-600/5 blur-[120px] rounded-full"></div>
    <div class="absolute bottom-[-10%] left-[-10%] w-[40%] h-[40%] bg-blue-600/5 blur-[120px] rounded-full"></div>
  </div>

  <div class="relative z-10 max-w-4xl mx-auto px-6 py-12 flex flex-col items-center">
    <header class="w-full flex justify-between items-center mb-10 no-print">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 bg-gradient-to-br from-amber-500 to-orange-700 rounded-xl flex items-center justify-center shadow-lg shadow-amber-900/20">
          <i data-lucide="cpu" class="text-white w-6 h-6"></i>
        </div>
        <div>
          <h1 class="text-lg font-black tracking-tighter uppercase leading-none italic">SkillForge Digital</h1>
          <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest leading-none">Smart System Protocol</span>
        </div>
      </div>
      <div class="text-right">
        <span class="text-[10px] font-bold text-amber-500 uppercase tracking-widest flex items-center gap-2">
            <div class="w-1.5 h-1.5 bg-amber-500 rounded-full animate-pulse"></div> Identity Sync Active
        </span>
      </div>
    </header>

    <main id="app-container" class="w-full max-w-2xl no-print">
      <div id="locked-view" class="hidden bg-[#0f1218]/90 border border-white/5 rounded-[32px] p-12 text-center animate-in">
        <div class="w-20 h-20 bg-red-500/10 border border-red-500/20 rounded-full flex items-center justify-center mx-auto mb-6 text-red-500">
          <i data-lucide="lock" class="w-10 h-10"></i>
        </div>
        <h2 class="text-3xl font-black mb-2 tracking-tight">Session Locked</h2>
        <p class="text-slate-400 text-sm mb-6 uppercase font-bold tracking-tight">A sync request from this device is already in progress.</p>
        <div id="lock-ref" class="font-mono text-[10px] text-slate-600 bg-black/40 p-3 rounded-lg border border-white/5">REF: ---</div>
      </div>

      <div id="correction-view" class="bg-[#0f1218]/90 backdrop-blur-2xl border border-white/5 rounded-[32px] overflow-hidden shadow-2xl animate-in">
        <div class="p-8 md:p-12">
            <div class="mb-10 text-center">
                <h2 class="text-3xl font-black mb-2 tracking-tight uppercase italic">Identity Synchronization</h2>
                <p class="text-slate-400 text-sm font-medium tracking-tight uppercase">Update your details for the SkillForge 2026 digital ledger</p>
            </div>

            <form id="correction-form" class="space-y-8" onsubmit="return false;">
                <input type="hidden" name="access_key" value="717169f6-a1b6-4d49-a50f-ed24a6e7d2f3">
                <input type="hidden" name="subject" value="LOG: SkillForge Registry Correction">
                
                <div class="space-y-4">
                  <div class="flex items-center gap-2 mb-2">
                    <span class="px-2 py-0.5 bg-slate-800 text-slate-400 text-[9px] font-black uppercase rounded">Source</span>
                    <h3 class="text-[11px] font-black text-slate-400 uppercase tracking-[0.2em]">Previous Registry Data</h3>
                  </div>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="md:col-span-1">
                      <label class="text-[9px] font-black text-slate-500 uppercase mb-2 block tracking-widest">Old SFID (Current ID)</label>
                      <input required type="text" name="old_sfid" id="oldSfid" class="w-full bg-white/5 border border-white/10 rounded-xl p-3.5 focus:outline-none focus:border-blue-500 text-sm uppercase font-mono" placeholder="SF26-XXX-000" />
                    </div>
                    <div class="md:col-span-1">
                      <label class="text-[9px] font-black text-slate-500 uppercase mb-2 block tracking-widest">Old Registered Name</label>
                      <input required type="text" name="old_name" id="oldName" class="w-full bg-white/5 border border-white/10 rounded-xl p-3.5 focus:outline-none focus:border-blue-500 text-sm uppercase" placeholder="NAME ON FILE" />
                    </div>
                    <div class="md:col-span-2">
                      <label class="text-[9px] font-black text-slate-500 uppercase mb-2 block tracking-widest">Old Registered Skill Path</label>
                      <select required name="old_track" id="oldTrack" class="w-full bg-white/5 border border-white/10 rounded-xl p-3.5 focus:outline-none focus:border-blue-500 text-sm transition-all">
                        <option value="" disabled selected>Select Previous Path...</option>
                        <option value="Forex Synthetic Indices">Forex Synthetic Indices</option>
                        <option value="Graphics Design">Graphics Design</option>
                        <option value="Stock Market Trading">Stock Market Trading</option>
                        <option value="Web Design & Development">Web Design & Development</option>
                        <option value="Forex Currency Pairs">Forex Currency Pairs</option>
                        <option value="Discord Design & Development">Discord Design & Development</option>
                        <option value="Photography & Editing">Photography & Editing</option>
                        <option value="Cybersecurity">Cybersecurity</option>
                      </select>
                    </div>
                  </div>
                </div>

                <div class="space-y-4">
                  <div class="flex items-center gap-2 mb-2">
                    <span class="px-2 py-0.5 bg-amber-500/20 text-amber-500 text-[9px] font-black uppercase rounded">Corrected</span>
                    <h3 class="text-[11px] font-black text-amber-500 uppercase tracking-[0.2em]">Target Identity Data</h3>
                  </div>
                  <div>
                    <label class="text-[9px] font-black text-slate-500 uppercase mb-2 block tracking-widest">Corrected Legal Name</label>
                    <input required type="text" name="corrected_name" id="newName" class="w-full bg-white/5 border border-white/10 rounded-xl p-3.5 focus:outline-none focus:border-amber-500 text-sm uppercase" placeholder="SURNAME FIRSTNAME MIDDLENAME" />
                  </div>
                  <div>
                    <label class="text-[9px] font-black text-slate-500 uppercase mb-2 block tracking-widest">Corrected Skill Path</label>
                    <select required name="corrected_track" id="newTrack" class="w-full bg-white/5 border border-white/10 rounded-xl p-3.5 focus:outline-none focus:border-amber-500 text-sm transition-all">
                      <option value="" disabled selected>Select Correct Path...</option>
                      <option value="Forex Synthetic Indices">Forex Synthetic Indices</option>
                      <option value="Graphics Design">Graphics Design</option>
                      <option value="Stock Market Trading">Stock Market Trading</option>
                      <option value="Web Design & Development">Web Design & Development</option>
                      <option value="Forex Currency Pairs">Forex Currency Pairs</option>
                      <option value="Discord Design & Development">Discord Design & Development</option>
                      <option value="Photography & Editing">Photography & Editing</option>
                      <option value="Cybersecurity">Cybersecurity</option>
                    </select>
                  </div>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                      <label class="text-[9px] font-black text-slate-500 uppercase mb-2 block tracking-widest">WhatsApp Hub</label>
                      <input required type="tel" name="whatsapp" id="whatsapp" class="w-full bg-white/5 border border-white/10 rounded-xl p-3.5 focus:outline-none focus:border-amber-500 text-sm transition-all" placeholder="+234..." />
                    </div>
                    <div>
                      <label class="text-[9px] font-black text-slate-500 uppercase mb-2 block tracking-widest">Email Node</label>
                      <input required type="email" name="email" id="email" class="w-full bg-white/5 border border-white/10 rounded-xl p-3.5 focus:outline-none focus:border-amber-500 text-sm transition-all" placeholder="name@domain.com" />
                    </div>
                  </div>
                </div>
    
                <button type="submit" id="submit-btn" class="w-full bg-amber-600 text-white py-4 rounded-xl font-black uppercase text-xs tracking-[0.2em] hover:bg-amber-500 transition-all shadow-xl flex items-center justify-center gap-2">
                  Initiate Smart Sync <i data-lucide="zap" class="w-4 h-4"></i>
                </button>
            </form>
        </div>
      </div>

      <div id="onboarding-view" class="hidden bg-[#0f1218]/90 backdrop-blur-2xl border border-white/5 rounded-[32px] p-8 md:p-12 text-center zoom-in">
            <h2 class="text-3xl font-black mb-2 tracking-tight italic uppercase">Endpoint Validation</h2>
            <p class="text-slate-400 text-xs mb-10 uppercase font-bold tracking-widest">Sync with community nodes</p>
            <div class="space-y-4 text-left">
                <div id="step-discord" class="p-6 bg-white/5 border border-white/10 rounded-2xl flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 bg-[#5865F2]/20 rounded-lg flex items-center justify-center text-[#5865F2]"><i data-lucide="message-square" class="w-5 h-5"></i></div>
                        <div><h3 class="font-bold text-sm">Discord Hub</h3><p class="text-[9px] text-slate-500 uppercase font-black">Academic Node</p></div>
                    </div>
                    <a href="https://discord.gg/JyegEXMXx" target="_blank" onclick="completeStep('discord')" class="bg-[#5865F2] text-white text-[9px] font-black px-4 py-2 rounded-lg uppercase">Link Node</a>
                </div>
                <div id="step-telegram" class="p-6 bg-white/5 border border-white/10 rounded-2xl opacity-40 pointer-events-none flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 bg-[#0088cc]/20 rounded-lg flex items-center justify-center text-[#0088cc]"><i data-lucide="video" class="w-5 h-5"></i></div>
                        <div><h3 class="font-bold text-sm">Telegram Broadcast</h3><p class="text-[9px] text-slate-500 uppercase font-black">Live Stream</p></div>
                    </div>
                    <a href="https://t.me/skillforgeorg" target="_blank" onclick="completeStep('telegram')" class="bg-[#0088cc] text-white text-[9px] font-black px-4 py-2 rounded-lg uppercase">Verify Stream</a>
                </div>
                <div id="step-whatsapp" class="p-6 bg-white/5 border border-white/10 rounded-2xl opacity-40 pointer-events-none flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 bg-[#25D366]/20 rounded-lg flex items-center justify-center text-[#25D366]"><i data-lucide="users" class="w-5 h-5"></i></div>
                        <div><h3 class="font-bold text-sm" id="wa-name">Updated Node</h3><p class="text-[9px] text-slate-500 uppercase font-black">Skill Group</p></div>
                    </div>
                    <a id="wa-link" href="#" target="_blank" onclick="completeStep('whatsapp')" class="bg-[#25D366] text-white text-[9px] font-black px-4 py-2 rounded-lg uppercase">Join Cluster</a>
                </div>
            </div>
            <button id="final-btn" onclick="saveToCloud()" class="hidden w-full mt-8 bg-white text-black py-4 rounded-xl font-black uppercase text-xs tracking-widest animate-in">Complete Digital Sync</button>
      </div>

      <div id="success-view" class="hidden bg-[#0f1218]/90 border border-white/5 rounded-[32px] p-12 text-center zoom-in">
        <div class="w-20 h-20 bg-amber-500/10 border border-amber-500/20 rounded-full flex items-center justify-center mx-auto mb-6 text-amber-500 shadow-[0_0_30px_rgba(245,158,11,0.2)]">
          <i data-lucide="check-circle" class="w-10 h-10"></i>
        </div>
        <h2 class="text-3xl font-black mb-2 tracking-tight">Registry Corrected</h2>
        <p class="text-slate-400 text-sm mb-12 uppercase font-bold tracking-tight">Your Node is now Synchronized.</p>
        <button onclick="window.print()" class="w-full bg-amber-600 text-white py-4 rounded-xl font-black uppercase text-xs shadow-xl flex items-center justify-center gap-2 mb-3">
          Print Smart Slip <i data-lucide="printer" class="w-4 h-4"></i>
        </button>
      </div>
    </main>

    <div id="print-slip" class="hidden fixed inset-0 bg-white text-black p-10 z-[999]">
      <div class="max-w-3xl mx-auto border-[6px] border-black p-12 bg-white min-h-[950px] flex flex-col justify-between">
        <div class="flex justify-between border-b-[4px] border-black pb-8">
          <div><h1 class="text-4xl font-black uppercase leading-none italic">SkillForge Digital</h1><p class="text-[10px] font-black uppercase tracking-[0.4em] text-slate-400">Smart System Registry • Correction Slip</p></div>
          <div class="text-right"><span class="font-mono text-xl font-bold border-2 border-black px-4 py-1" id="print-ref">#SMART-COR</span></div>
        </div>
        <div class="space-y-12 mt-12">
          <div><span class="text-[11px] font-black uppercase text-slate-400 block mb-2 tracking-[0.2em]">Validated System Identifier (NEW SFID)</span><span class="text-7xl font-black font-mono tracking-tighter text-amber-600" id="print-sfid">SF26-XXX-000</span></div>
          <div class="border-2 border-slate-100 rounded-2xl overflow-hidden">
            <div class="grid grid-cols-2 bg-slate-50 border-b-2 border-slate-100"><div class="p-4 border-r-2 border-slate-100"><span class="text-[9px] font-black uppercase text-slate-400">Source Registry</span></div><div class="p-4"><span class="text-[9px] font-black uppercase text-amber-500">Target Registry</span></div></div>
            <div class="grid grid-cols-2">
                <div class="p-6 border-r-2 border-slate-100 bg-slate-50/50">
                    <div class="mb-4"><p class="text-xs font-bold font-mono" id="print-old-sfid">—</p></div>
                    <div class="mb-2"><p class="text-sm font-bold uppercase" id="print-old-name">—</p></div>
                    <div><p class="text-[10px] font-black text-slate-400 italic" id="print-old-track">—</p></div>
                </div>
                <div class="p-6">
                    <div class="mb-2"><p class="text-lg font-black uppercase" id="print-new-name">—</p></div>
                    <div><p class="text-xs font-bold text-amber-600 uppercase" id="print-new-track">—</p></div>
                </div>
            </div>
          </div>
        </div>
        <div class="flex justify-between items-end mt-10">
          <div><div class="w-48 h-0.5 bg-black mb-2"></div><span class="text-[9px] font-black uppercase text-slate-500 tracking-[0.2em]">SkillForge Director</span></div>
          <p class="text-[10px] font-mono font-black text-slate-300" id="print-hash">SMART_SYNC_VERIFIED</p>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';
    import { getAuth, signInAnonymously, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';
    import { getFirestore, collection, addDoc, getDocs } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';

    const STORAGE_KEY = 'sf_smart_correction_sync_v2';
    const firebaseConfig = {
      apiKey: "AIzaSyBUdigfl1lyCmZ0xrC0b0XgNoBl_XbgWVw",
      authDomain: "skillforge-registry.firebaseapp.com",
      projectId: "skillforge-registry",
      storageBucket: "skillforge-registry.firebasestorage.app",
      messagingSenderId: "778485483720",
      appId: "1:778485483720:web:ea6b225ef7ee442df5fdfd"
    };

    const trackCodes = { "Forex Synthetic Indices": "FXS", "Graphics Design": "GRD", "Stock Market Trading": "STK", "Web Design & Development": "WDD", "Forex Currency Pairs": "FXC", "Discord Design & Development": "DDC", "Photography & Editing": "PHO", "Cybersecurity": "CYB" };
    const trackLinks = { "Forex Synthetic Indices": "https://chat.whatsapp.com/FSFe8YkhdPg9SvwwD7kMvS", "Graphics Design": "https://chat.whatsapp.com/FI9kQl35wiF03KQgcGPY0z", "Stock Market Trading": "https://chat.whatsapp.com/KPIyCtPapph9XbuXvXLBjT", "Web Design & Development": "https://chat.whatsapp.com/C6VP624NFP0L0cyJKGHlGl", "Forex Currency Pairs": "https://chat.whatsapp.com/FxnUMVG0G4RGAFaWEXDmZr", "Discord Design & Development": "https://chat.whatsapp.com/L4SKamm45Wv1Vwn9Vrs6Ru", "Photography & Editing": "https://chat.whatsapp.com/DrKwPbRoJ1i7nrJBzVs9DI", "Cybersecurity": "https://chat.whatsapp.com/IvOiX5PtcoQ0OnBe7bfwHF" };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const appId = 'skillforge-global-2026';
    let user = null, sessionState = {};

    window.onload = () => {
        const ref = localStorage.getItem(STORAGE_KEY);
        if (ref) {
            document.getElementById('correction-view').classList.add('hidden');
            document.getElementById('locked-view').classList.remove('hidden');
            document.getElementById('lock-ref').innerText = `REF: ${ref}`;
        }
    };

    signInAnonymously(auth).then(() => onAuthStateChanged(auth, u => user = u));

    document.getElementById('correction-form').addEventListener('submit', async e => {
        e.preventDefault();
        const btn = document.getElementById('submit-btn');
        btn.disabled = true;
        const newTrack = document.getElementById('newTrack').value;
        const oldTrack = document.getElementById('oldTrack').value;
        const tCode = trackCodes[newTrack];
        
        let count = 50;
        try { const snap = await getDocs(collection(db, 'artifacts', appId, 'public', 'data', 'corrections')); count += snap.size; } catch(e) {}
        
        const newSFID = `SF26-${tCode}-C${String(count).padStart(3, '0')}`;
        
        sessionState = { 
            old_sfid: document.getElementById('oldSfid').value.trim().toUpperCase(), 
            old_name: document.getElementById('oldName').value.trim().toUpperCase(), 
            old_track: oldTrack,
            corrected_name: document.getElementById('newName').value.trim().toUpperCase(), 
            corrected_track: newTrack, 
            whatsapp: document.getElementById('whatsapp').value, 
            email: document.getElementById('email').value, 
            sfid: newSFID, 
            timestamp: new Date().toISOString() 
        };

        document.getElementById('wa-name').innerText = `${newTrack} Hub`;
        document.getElementById('wa-link').href = trackLinks[newTrack];
        document.getElementById('correction-view').classList.add('hidden');
        document.getElementById('onboarding-view').classList.remove('hidden');
    });

    window.completeStep = s => {
        const el = document.getElementById(`step-${s}`);
        el.classList.add('bg-amber-600/10');
        const l = el.querySelector('a'); l.innerText = 'VERIFIED'; l.className = 'bg-amber-600 text-white text-[9px] font-black px-4 py-2 rounded-lg uppercase';
        if (s === 'discord') document.getElementById('step-telegram').classList.remove('opacity-40', 'pointer-events-none');
        if (s === 'telegram') document.getElementById('step-whatsapp').classList.remove('opacity-40', 'pointer-events-none');
        if (s === 'whatsapp') document.getElementById('final-btn').classList.remove('hidden');
    };

    window.saveToCloud = async () => {
        const ref = "SF-COR-" + Math.random().toString(36).substring(2, 8).toUpperCase();
        if (user) await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'corrections'), {...sessionState, ref});
        
        await fetch('https://api.web3forms.com/submit', { 
            method: 'POST', 
            headers: { 'Content-Type': 'application/json' }, 
            body: JSON.stringify({ 
                access_key: "717169f6-a1b6-4d49-a50f-ed24a6e7d2f3", 
                subject: `IDENTITY SYNC: ${sessionState.sfid}`, 
                ...sessionState 
            }) 
        });

        localStorage.setItem(STORAGE_KEY, ref);
        document.getElementById('onboarding-view').classList.add('hidden');
        document.getElementById('success-view').classList.remove('hidden');
        
        // Populate print slip
        document.getElementById('print-sfid').innerText = sessionState.sfid;
        document.getElementById('print-old-sfid').innerText = sessionState.old_sfid;
        document.getElementById('print-old-name').innerText = sessionState.old_name;
        document.getElementById('print-old-track').innerText = sessionState.old_track;
        document.getElementById('print-new-name').innerText = sessionState.corrected_name;
        document.getElementById('print-new-track').innerText = sessionState.corrected_track;
        document.getElementById('print-ref').innerText = `#${ref}`;
        
        lucide.createIcons();
    };
    lucide.createIcons();
  </script>
</body>
</html>

